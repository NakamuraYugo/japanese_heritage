<div class="container">
  <div class="spot-details">
    <div class="spot-detail-section layout-two-col">
      <!-- 左カラム：タイトル・詳細・ギャラリー -->
      <div class="layout-two-col__info">
        <h2 class="spot-title"><%= @spot.name %></h2>
        <p class="spot-description"><%= @spot.description %></p>
        <h3 class="section-title">スポット画像</h3>
        <div class="spot-gallery">
          <% @spot.images.each do |image| %>
            <div class="gallery-item">
              <%= image_tag image.name.url, class: 'spot-image' %>
            </div>
          <% end %>
        </div>
      </div>

      <!-- 右カラム：マップ -->
      <div class="layout-two-col__map">
        <h3 class="section-title">場所</h3>

        <% if @spot.latitude.present? && @spot.longitude.present? %>
          <p class="spot-address"><%= @spot.address %></p>
          <div class="map-container">
            <div id="map"
                data-lat="<%= @spot.latitude %>"
                data-lng="<%= @spot.longitude %>"></div>
          </div>
          <%= javascript_pack_tag 'spot_map' %>
          <%= javascript_include_tag \
            "https://maps.googleapis.com/maps/api/js?key=#{ENV['GOOGLE_MAPS_API_KEY']}&callback=initMap",
            async: true, defer: true %>

        <% elsif @spot.address.present? %>
          <p class="spot-address"><%= @spot.address %></p>
          <div class="alert alert-warning no-location-message">
            入力された住所「<strong><%= @spot.address %></strong>」は
            マップ上で見つかりませんでした。<br>
            お手数ですが、正式な住所またはスポット名をご確認の上、修正してください。
            <%= link_to "スポットを編集する", edit_spot_path(@spot),
                        class: "btn btn-sm btn-outline-primary mt-2" %>
          </div>

        <% else %>
          <div class="alert alert-warning no-location-message">
            まだ住所が登録されていません。<br>
            住所や正式名称を入力していただくと、
            正確な地図表示が可能になります。<br>
            <%= link_to "スポットを編集する", edit_spot_path(@spot),
                        class: "btn btn-sm btn-outline-primary mt-2" %>
          </div>
        <% end %>
      </div>




    <% if current_user == @spot.user %>
      <div class="management-buttons">
        <%= link_to '編集する', edit_spot_path(@spot), class: 'btn btn-primary' %>
        <%= link_to '削除する', spot_path(@spot), class: 'btn btn-danger sweet-delete' %>
      </div>
    <% end %>
  </div>
</div>
